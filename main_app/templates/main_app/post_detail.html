{% extends "base.html"%} {% block content %}

<h1>Post Details</h1>

<div class="row">
  <div class="col s6 col-offset-3">
    <div class="card">
      <div class="card-content">
        <div class="card-content">
          <span class="card-title">{{post.title}}</span>

          <!-- Insert photo markup below this comment -->
          <div class="detail-thumbnail">
            <model-viewer
              bounds="tight"
              enable-pan
              src="/media/{{post.model}}"
              ar
              ar-modes="webxr scene-viewer quick-look"
              camera-controls
              environment-image="neutral"
              poster="/media/{{post.model}}"
              seamless-poster
              shadow-intensity="1"
              interaction-prompt-threshold="15000000"
            >
              <div class="progress-bar hide" slot="progress-bar">
                <div class="update-bar"></div>
              </div>
              <button slot="ar-button" id="ar-button">
                View in your space
              </button>
            </model-viewer>
          </div>
        <div class="picture-viewer">
           <div class="container gallery">
            {% for photo in post.photo_set.all %}
            <div class="mySlides">
              <img class="responsive-img card-panel" src="{{photo.url}}">
            </div>
            {% empty %}
            
            <div class="card-panel teal-text center-align">
              No Photos Uploaded
            </div>
            {% endfor %}
          
            <!-- Next and previous buttons -->
            <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
            <a class="next" onclick="plusSlides(1)">&#10095;</a>
          
            <!-- Image text -->
            <div class="caption-container">
              <p id="caption"></p>
            </div>
            {% for photo in post.photo_set.all %}
            <div class="column">
              <img class="demo curser" src="{{photo.url}}" style="width:100%" onclick="currentSlide({{photo.id}})">
            </div>
            {% empty %}
            
            <div class="card-panel teal-text center-align">
              No Photos Uploaded
            </div>
            {% endfor %}
          </div>
        </div>
        <br>
        <br>
        <Br>
        <br>
        <br>
        <br>
        <br>
        <br>

    
        
        
      
        <div>
          <p>{{post.text_content}}</p>
          <p>Tags: {{post.tags}}</p>
          <p>Download Count: {{post.downloads}}</p>
          <p>{{account.name}}</p>
          </div>
        
        {% comment %} <div>
          <a href="{% url 'comment_create' post.id %}">Add Comment</a>
        </div> {% endcomment %}
        
          <div class="card-action">
            <form
              action="{% url 'add_photo' post.id %}"
              enctype="multipart/form-data"
              method="POST"
              class="card-panel"
            >
              {% csrf_token %}
              <input type="file" name="photo-file" />
              <br /><br />
              <input type="submit" class="btn" value="Upload Photo" />
            </form>
            <a href="{% url 'post_update' post.id%}">Edit</a>
            <a href="{% url 'post_delete' post.id%}">Delete</a>
          </div>
        </div>
      </div>
    </div>
  </br>

  <hr>
  {% if not liked %}
  <form action=" {% url 'like_post' post.id %}" method="POST">
    {% csrf_token %}
    <button type="submit" name="post_id" value="{{ post.id }}" class="btn color blue" >Like</button> -{{post.total_likes}} Likes
  </form>
  {% else %}
  <form action=" {% url 'unlike_post' post.id %}" method="POST">
    {% csrf_token %}
    <button type="submit" name="post_id" value="{{ post.id }}" class="btn color red" >Like</button> -{{post.total_likes}} Likes
  </form>
  {% endif %}
  </br>
  </br>


  <h5> Comments </h5>

  {% if not post.comments.all %}
    No Comments yet... <a href="{% url 'comment_create' post.pk %}">
    Add One</a>
  {% else %}
  </br>
  <a href="{% url 'comment_create' post.pk %}">Add Comment</a>
</br>
      {% for comment in post.comments.all %}  
</br></hr>
        <strong>{{ comment.title }}</strong>
        </br>
        {{ comment.text_content }}
      </br>
      {%if comment.images %}
        <img src='{{ comment.images }}'>
      </br></br>

      {%endif%}
      <a href="{% url 'comment_update' comment.id%}">Edit</a>
      <a href="{% url 'comment_delete' comment.id%}">Delete</a>
    </hr>
    {% endfor %}
  {% endif %}
    {% comment %} <table>
      <tr>
        <th>Title</th>
        <th>Content</th>
        <th>Images</th>
      </tr>
      {% for comment in post.comments%}
      <tr>
        <td>{{comment.title}}</td>
        <td>{{comment.text_content}}</td>
        <td>{{comment.images}}</td>
      </tr>
      {%endfor%}
    </table> {% endcomment %}
  </div>
  {% endblock %}
</div>
